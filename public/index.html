<!DOCTYPE html>
<head>
	<meta charset="utf-8">
	<title>Chat Without Borders</title>

	<link type="text/css" rel="stylesheet" href="/css/bootstrap-cerulean.min.css">
	<link type="text/css" rel="stylesheet" href="/css/worldchat.css">
	<link type="text/css" rel="stylesheet" href="/css/flags/flags.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

	<script src="/socket.io/socket.io.js"></script>
	<script charset="utf-8" src="/js/jquery-1.9.0.min.js"></script>
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
	<script charset="utf-8" src="/js/plugins.js"></script>
	<script charset="utf-8" src="/js/worldchat.js"></script>
	

</head>
<body>

	<div class="navbar navbar-default navbar-fixed-top hidden" role="navigation">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">World Chat</a>
			</div>
			<div class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<!-- <li class="active"><a href="#">Home</a></li> -->
				</ul>
			</div>
		</div>
	</div>

	<section>
		<div class="jumbotron intro text-center">
			<h1>
				Chat Without Borders
				<span class="label label-primary beta-label">beta</span>
			</h1>
			<div class="flag-strip">

				<span class="flag flag-no"></span>
				<span class="flag flag-fr"></span>
				<span class="flag flag-de"></span>
				<span class="flag flag-jp"></span>
				<span class="flag flag-bg"></span>
				<span class="flag flag-fi"></span>
				<span class="flag flag-lv"></span>
				<span class="flag flag-ch"></span>
				<span class="flag flag-at"></span>
				<span class="flag flag-au"></span>
				<span class="flag flag-kr"></span>
				<span class="flag flag-il"></span>
				<span class="flag flag-pe"></span>
				<span class="flag flag-cn"></span>
				<span class="flag flag-br"></span>
				<span class="flag flag-mo"></span>
				<span class="flag flag-th"></span>
				<span class="flag flag-fj"></span>
				<span class="flag flag-se"></span>
				<span class="flag flag-gr"></span>
				<span class="flag flag-ht"></span>
				<span class="flag flag-lk"></span>
				<span class="flag flag-vn"></span>
				<span class="flag flag-bs"></span>
				<span class="flag flag-ir"></span>
				<span class="flag flag-dz"></span>
				<span class="flag flag-eg"></span>
				<span class="flag flag-et"></span>
				<span class="flag flag-sr"></span>
				<span class="flag flag-ve"></span>
				<span class="flag flag-ye"></span>
				<span class="flag flag-pw"></span>

			</div>
			<p class="lead">Chat with anyone in the world, regardless of your language difference.</p>
			<hr>
			<form class="form-inline form-login">
				<div class="row">
					<div class="form-group col-xs-12 col-sm-6 form-group-name">
						<label for="input-name">Name</label>
						<input type="text" class="form-control input-username" id="input-name" required>
					</div>
					<div class="form-group col-xs-12 col-sm-6 form-group-language">
						<label for="input-language">Language</label>
						<select id="input-language" class="form-control">
							<option value="en">English</option>
							<option value="ru">Russian</option>
							<option value="fr">French</option>
						</select>
					</div>
				</div>

				<div class="row form-group-submit">
					<button type="submit" class="btn btn-primary btn-lg btn-block btn-start">
						<i class="fa fa-globe"></i> enter
					</button> 
				</div>

			</form>
		</div>
	</section>

	<div class="container">
		
		<div class="row wrapper-main hidden">

			<div class="col-xs-12">
				<ul class="breadcrumb">
					<li class="active status-bar">
						Chatting as <span class="username"></span> &mdash; 
						Your language is set to <span class="language"></span>
					</li>
				</ul>
			</div>

			<div class="col-xs-12 col-sm-9">

				<div class="row chat-window">
					<div class="col-xs-12">
						
						<!-- holds all messages -->
						<div class="messages"></div>

						<!-- chat input -->
						<div class="form-group">
							<textarea class="form-control" rows="2" id="input-text"></textarea>
						</div>

						<!-- send button -->
						<div class="form-group text-right">
							<button type="submit" class="btn btn-primary" id="btn-send-message">Send</button>
						</div>

					</div>
				</div>


			</div>

			<div class="col-xs-12 col-sm-3">
				<div class="row side-col">
					<div class="col-xs-12">
						<div class="users-list">
							<span class="title">Users Connected</span>
							<ul class="user-list-ul"></ul>
						</div>
						
						<div class="google-attribution">
							<a href="http://translate.google.com" target="_blank">
								<img src="/images/google-translate.png">
							</a>
						</div>

					</div>
				</div>
			</div>

		</div>

		

		

	</div>
	
	<footer class="">
		<p><strong>World Chat</strong></p>
		<p>Built by <a href="http://adambailin.com">Adam Bailin</a></p>
		<p><a href="https://github.com/abailin/worldtweets">Source on Github</a></p>
	</footer>

<div class="modal" id="modal-about">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
        <h4 class="modal-title"><strong>About</strong></h4>
      </div>
      <div class="modal-body">
        <p>Chat without borders is a chatroom which allows users to communicate regardless of the language they write. After choosing your language and joining the chat, all incoming messages are automatically translated into your preferred language.</p>
        <p>Translations are powered by <a href="#">Google Translate</a>.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Get started</button>
      </div>
    </div>
  </div>
</div>

<script type="text/html" id="tmpl-message-line">
<div class="message">
		<span class="username"><%= o.from_user %></span>
		<span class="message-body">
			<span class="translation"><%= o.message %></span>
			
			<% if (o.original && o.original.length) { %>
				<span class="original">(<%= o.original %>)</span>
			<% } %>

		</span>
</div>
</script>

<script type="text/html" id="tmpl-message-user-left">
<div class="message user-left">
	<%= o.name %> has left
</div>
</script>

<script type="text/html" id="tmpl-message-user-joined">
<div class="message user-joined">
	<%= o.name %> [<%= o.lang %>] has joined
</div>
</script>



<script>
var models = {};

models.User = Backbone.Model.extend({
	defaults: {
		id: null,
		name: null,
		lang: null
	},
	initialize: function() {
		console.log("user initialized");
	}
});

models.UserList = Backbone.Collection.extend({
	model: models.User
});

var views = {};

views.UserItem = Backbone.View.extend({
	tagName: "li",
	className: "user-list-item",
	
	initialize: function() {
		console.log("Render UserItem (view)");
	},
	render: function() {
		this.el.innerHTML = this.model.get('name') + " [" + this.model.get('lang') + "]";
		return this;
	}
});

views.UserList = Backbone.View.extend({
	el: ".user-list-ul",
	collection: null,
	
	initialize: function(options) {
		this.collection = options.collection;
		_.bindAll(this, 'render');
		// this.collection.on('add', this.render, this);
		this.collection.on('add', this.render);
		this.collection.on('remove', this.render);
		this.collection.on('reset', this.render);
	},

	render: function() {
		console.log("Render MAIN UserList (view)");
		var element = $(this.el);
		element.empty();

		this.collection.forEach(function(item) {
			var itemView = new views.UserItem({
				model: item
			});

			element.append(itemView.render().el);
		});
	}
});

</script>

<script>
App.init();
$(".form-login").on("submit", function(e) { e.preventDefault(); });
/*
Attribution
flags from: https://www.flag-sprites.com/
*/
</script>

</body>
</html>
